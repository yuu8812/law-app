query findLaws(
  $type: Int = 0
  $star: Int = 0
  $like: Int = 0
  $userId: uuid = "00000000-0000-0000-0000-000000000000"
  $type3: Int = 0
) {
  laws(
    order_by: {
      law_revisions_aggregate: { max: { enforcement_date: asc } }
      reactions_aggregate: { count: asc }
    }
  ) {
    id
    api_law_id
    arguments_aggregate(limit: 1) {
      aggregate {
        count
      }
      nodes {
        user {
          name
          id
        }
        title
        description
        created_at
        reactions_aggregate_1: reactions_aggregate(where: { type: { _eq: $type } }) {
          aggregate {
            count
          }
        }
      }
    }
    law_revisions(limit: 1) {
      abbrev
      abbrev_kana
      abbrev_kana_seion
      ad_year
      enforcement_comment
      enforcement_date
      era
      id
      lang
      year
      title_kana_seion
      title_kana
      title
      repeal_type
      remain_in_force
      promulgate_month
      promulgate_day
      old_law_title_kana_seion
      old_law_title_kana
      old_law_title
      num_kanji
      num
      mission
      law_type {
        type_en
        type_ja
      }
      law_category {
        category_number
        category_ja
      }
      law_status {
        status_en
        status_ja
      }
      api_law_data_info
      api_law_revision_id
      api_law_type_num
    }
    star: reactions_aggregate(where: { type: { _eq: $star } }) {
      aggregate {
        count
      }
    }
    like: reactions_aggregate(where: { type: { _eq: $like } }) {
      aggregate {
        count
      }
    }
    law_views(where: { user_id: { _eq: $userId } }) {
      id
    }
    law_revisions_aggregate {
      aggregate {
        count
      }
    }
    law_summaries_aggregate(limit: 1) {
      aggregate {
        count
      }
      nodes {
        text
        user {
          id
          name
        }
      }
    }
    comments_aggregate {
      aggregate {
        count
      }
      nodes {
        comment_reactions_aggregate(where: { type: { _eq: $type3 } }, limit: 1) {
          aggregate {
            count
          }
        }
        text
        user {
          id
          name
        }
      }
    }
  }
}

query findLaw(
  $id: uuid = "00000000-0000-0000-0000-000000000000"
  $userId: uuid = "00000000-0000-0000-0000-000000000000"
  $_eq: Int = 1
  $_eq1: uuid = "00000000-0000-0000-0000-000000000000"
) {
  laws_by_pk(id: $id) {
    id
    law_views(where: { user_id: { _eq: $userId } }) {
      id
    }
    law_revisions {
      title
      id
      law_full_text
      law_status {
        status_en
        status_ja
      }
      law_type {
        type_en
        type_ja
      }
      law_category {
        category_number
        category_ja
      }
      law_revision_columns {
        comments_aggregate {
          aggregate {
            count
          }
        }
        reactions_aggregate(where: { type: { _eq: $_eq }, law_id: { _eq: $_eq1 } }) {
          aggregate {
            count
          }
        }
        column_id
        id
      }
    }
  }
}

query findCommentsByLawId($lawId: uuid!, $_eq: uuid = "00000000-0000-0000-0000-000000000000") {
  laws_by_pk(id: $lawId) {
    id
    comments {
      id
      text
      user {
        name
        id
      }
      created_at
      comment_reactions_aggregate {
        aggregate {
          count
        }
      }
      comment_reactions(where: { user_id: { _eq: $_eq } }) {
        user_id
      }
    }
  }
}

query findCommentsOnLawRevision(
  $columnId: String
  $type: Int = 0
  $userId: uuid = "00000000-0000-0000-0000-000000000000"
  $revisionId: uuid = "00000000-0000-0000-0000-000000000000"
) {
  law_revision_columns(
    where: { column_id: { _eq: $columnId }, law_revision: { id: { _eq: $revisionId } } }
  ) {
    comments_aggregate(order_by: { created_at: desc }) {
      aggregate {
        count
      }
      nodes {
        id
        text
        created_at
        user {
          name
          id
        }
        id
        comment_reactions_aggregate(where: { type: { _eq: $type } }) {
          aggregate {
            count
          }
        }
        isLiked: comment_reactions(where: { user_id: { _eq: $userId }, type: { _eq: $type } }) {
          id
        }
      }
    }
  }
}

query findUser($_eq: String = "") {
  users(where: { authentication_id: { _eq: $_eq } }) {
    id
  }
}

mutation createLawRevisionColumnComment(
  $column_id: String
  $law_revision_id: uuid = "00000000-0000-0000-0000-000000000000"
  $text: String
  $author_id: uuid = "00000000-0000-0000-0000-000000000000"
) {
  insert_law_revision_columns_one(
    object: {
      column_id: $column_id
      law_revision_id: $law_revision_id
      comments: { data: { text: $text, author_id: $author_id } }
    }
    on_conflict: { constraint: law_revision_columns_column_id_key, update_columns: column_id }
  ) {
    id
  }
}

mutation createUser($authentication_id: String, $name: String) {
  insert_users(objects: { authentication_id: $authentication_id, name: $name }) {
    returning {
      id
    }
  }
}

mutation createCommentReaction(
  $comment_id: uuid = "00000000-0000-0000-0000-000000000000"
  $user_id: uuid = "00000000-0000-0000-0000-000000000000"
  $type: Int
) {
  insert_comment_reactions_one(
    object: { comment_id: $comment_id, user_id: $user_id, type: $type }
  ) {
    id
  }
}

mutation deleteCommentReaction(
  $comment_id: uuid = "00000000-0000-0000-0000-000000000000"
  $user_id: uuid = "00000000-0000-0000-0000-000000000000"
) {
  delete_comment_reactions(
    where: { comment_id: { _eq: $comment_id }, user_id: { _eq: $user_id } }
  ) {
    returning {
      id
    }
  }
}

mutation createWatchedLaw(
  $user_id: uuid = "00000000-0000-0000-0000-000000000000"
  $law_id: uuid = "00000000-0000-0000-0000-000000000000"
) {
  insert_law_views_one(object: { user_id: $user_id, law_id: $law_id }) {
    id
  }
}
